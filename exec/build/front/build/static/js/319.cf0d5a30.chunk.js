"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[319],{11093:function(e,t,n){n.d(t,{Z:function(){return c}});var a=n(72791),r=n(80184);function s(e){var t=e.imgfile,n=e.newImgfile,s=e.imgW,c=e.imgH,i=(0,a.useRef)(null),u=new Image,l=URL.createObjectURL(t);return u.src=l,u.onload=function(){var e=i.current,t=null===e||void 0===e?void 0:e.getContext("2d");if(t&&e){e.width=s,e.height=c,t.fillStyle="white",t.fillRect(0,0,s,c),t.drawImage(u,0,0,s,c);var a=e.toDataURL("image/jpeg");n(a),URL.revokeObjectURL(l)}},(0,r.jsx)("div",{id:"resizer",children:(0,r.jsx)("canvas",{ref:i,children:" "})})}var c=a.memo(s)},28319:function(e,t,n){n.r(t),n.d(t,{default:function(){return j}});var a=n(88214),r=n(42982),s=n(15861),c=n(70885),i=n(72791),u=n(80184);var l=function(e){var t=e.type,n=e.content,a=e.image;return(0,u.jsx)("div",{id:"chat",className:"recv"===t?"left":"right",children:a?(0,u.jsx)("img",{src:"data:image/jpeg;base64,".concat(a),alt:"\uc774\ubbf8\uc9c0",className:"chat__img",title:"\uc774\ubbf8\uc9c0"}):(0,u.jsx)("p",{className:"chat-content fs-16 notoReg",children:n})})},o=n(20501),f=n(16871),m=n(39575),d=n(64826),g=n(11093);var h=n.p+"static/media/ImgIcon.ef67182f308a1c6b4ee997a224e5b028.svg",p=n(68707),v=n(34108),x=n(97198);var j=function(){var e=(0,o.lr)(),t=(0,c.Z)(e,1)[0],n=(0,f.s0)(),j=t.get("with"),Z=(0,i.useState)([]),w=(0,c.Z)(Z,2),b=w[0],N=w[1],y=(0,i.useState)(!1),S=(0,c.Z)(y,2),k=S[0],I=S[1],R=(0,i.useState)(!1),C=(0,c.Z)(R,2),_=C[0],U=C[1],E=(0,i.useState)(!1),L=(0,c.Z)(E,2),O=L[0],H=L[1],P=(0,i.useState)(0),W=(0,c.Z)(P,2),z=W[0],B=W[1],D=(0,i.useState)(0),F=(0,c.Z)(D,2),K=F[0],T=F[1],q=(0,i.useState)(!1),A=(0,c.Z)(q,2),G=A[0],J=A[1],M=(0,i.useState)(""),Q=(0,c.Z)(M,2),V=Q[0],X=Q[1],Y=(0,i.useState)(null),$=(0,c.Z)(Y,2),ee=$[0],te=$[1],ne=(0,i.useRef)(null),ae=(0,i.useRef)(null),re=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I(!0),e.next=3,(0,p.I5)(j,K);case 3:"SUCCESS"===(t=e.sent).message&&(t.data.fromProfileImg&&X(t.data.fromProfileImg),t.data.hasNext||J(!0),_?N([].concat((0,r.Z)(b),(0,r.Z)(t.data.list))):(U(!0),N((0,r.Z)(t.data.list))),0!==t.data.list.length&&T(t.data.list[t.data.list.length-1].idx)),I(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(e){e.forEach((function(e){e.isIntersecting&&!k&&B((function(e){return e+1}))}))},ce=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(t,n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O){e.next=6;break}return H(!0),N([{type:"send",content:t,image:n}].concat((0,r.Z)(b))),e.next=5,(0,p.St)(j,t,n);case 5:H(!1);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ie=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce("",t.replace("data:image/jpeg;base64,",""));case 2:te(null);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){j||n("/404")}),[]),(0,i.useEffect)((function(){re()}),[z]),(0,i.useEffect)((function(){var e=new IntersectionObserver(se,{threshold:.1});return ne.current&&e.observe(ne.current),function(){ne.current&&e.unobserve(ne.current)}}),[b]),(0,u.jsxs)("div",{className:"wrapper",children:[(0,u.jsxs)("div",{id:"chat-room",children:[(0,u.jsxs)("header",{className:"header flex align-center",children:[(0,u.jsx)("img",{className:"chat-room__user-img",src:""!==V?"data:image/jpeg;base64,".concat(V):d.Z,alt:"\uc720\uc800\ub354\ubbf8"}),(0,u.jsx)("p",{className:"chat-room__user-nick-name notoBold fs-24",children:j})]}),(0,u.jsx)("div",{className:"chat-list",children:0!==b.length?(0,u.jsxs)(u.Fragment,{children:[b.map((function(e){return(0,u.jsx)(l,{type:e.type,content:e.content,image:e.image},(0,m.Z)())})),!G&&(k?(0,u.jsx)("div",{className:"spinner-wrraper\r flex justify-center",children:(0,u.jsx)("img",{src:v.Z,title:"\ub85c\ub529\uc2a4\ud53c\ub108",alt:"\ub85c\ub529\uc2a4\ud53c\ub108",className:"loading-spinner"})}):(0,u.jsx)("div",{ref:ne,className:"observerTarget"}))]}):(0,u.jsx)("div",{className:"no-chat flex align-center justify-center fs-24",children:_&&"\uc8fc\uace0\ubc1b\uc740 \ub300\ud654\uac00 \uc5c6\uc2b5\ub2c8\ub2e4!"})}),(0,u.jsx)("input",{type:"text",placeholder:"\ucc44\ud305\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.",className:"chat-input notoReg fs-15",onKeyUp:function(e){"Enter"===e.key&&""!==e.target.value&&_&&(ce(e.target.value,null),e.target.value="")}}),(0,u.jsx)("footer",{className:"chat-footer",children:(0,u.jsx)("button",{type:"button",className:"chat-btn",onClick:function(){var e;null===(e=ae.current)||void 0===e||e.click()},children:(0,u.jsx)("img",{src:h,alt:"\uc774\ubbf8\uc9c0\uc5c5\ub85c\ub4dc",className:"chat__img-icon"})})}),(0,u.jsx)("input",{type:"file",accept:"image/*",ref:ae,onChange:function(){var e;if(null!==(e=ae.current)&&void 0!==e&&e.files){var t=ae.current.files[0];t&&(0,x.Z)(t)&&te(t)}}})]}),ee&&(0,u.jsx)(g.Z,{imgfile:ee,newImgfile:ie,imgW:200,imgH:200})]})}},97198:function(e,t){t.Z=function(e){var t=e.name.substring(e.name.lastIndexOf(".")+1,e.name.length).toLowerCase();return"jpg"===t||"png"===t||"gif"===t||"jpeg"===t||(alert("\uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ud655\uc7a5\uc790\uc5d0\uc694!"),!1)}}}]);
//# sourceMappingURL=319.cf0d5a30.chunk.js.map